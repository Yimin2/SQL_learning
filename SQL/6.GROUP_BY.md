USE world;

SELECT * FROM COUNTRY;

-- 각 항목마다 count (*) 된 것
SELECT COUNTRY.CONTINENT, COUNT(0) FROM COUNTRY
GROUP BY CONTINENT;

SELECT COUNTRY.CONTINENT, COUNT(0) FROM COUNTRY
GROUP BY CONTINENT ORDER BY COUNT(0) DESC;

SELECT COUNTRY.CONTINENT, COUNT(*), ROUND (AVG(COUNTRY.POPULATION ) /1000,0) AS 인구수, AVG(COUNTRY.LIFEEXPECTANCY ) FROM COUNTRY
GROUP BY COUNTRY.CONTINENT
ORDER BY 인구수 DESC;

SELECT COUNTRY.CONTINENT, region, COUNT(0) FROM COUNTRY
GROUP BY CONTINENT, COUNTRY.REGION
ORDER BY continent, count(*);

SELECT CONTINENT, COUNT(*) FROM COUNTRY
WHERE COUNTRY.POPULATION >= 100000000
GROUP BY CONTINENT;

SELECT CONTINENT, COUNT(*) FROM COUNTRY
GROUP BY CONTINENT
HAVING COUNT(*) > 10;

SELECT CONTINENT, AVG(COUNTRY.POPULATION ) FROM COUNTRY
GROUP BY CONTINENT
HAVING AVG(COUNTRY.POPULATION ) > 20000000;


USE sakila;

SELECT * FROM FILM;

-- 등급(rating)별로 다음 정보를 조회하세요:
-- - 등급, 영화 개수
SELECT FILM.RATING, count(*)
FROM FILM
GROUP BY FILM.RATING;
-- - 영화 개수가 많은 순서로 정렬
SELECT FILM.RATING, count(*) FROM FILM
GROUP BY FILM.RATING
ORDER BY count(*) DESC;

-- 등급(rating)별로 다음 정보를 조회하세요:
-- - 등급, 영화 개수, 평균 대여료 (소수점 둘째 자리), 최고 대여료, 최저 대여료
-- - 평균대여료 내림차순 정렬
SELECT FILM.RATING, count(*),
ROUND(AVG(rental_rate),2) AS 평균대여료,
MAX(FILM.RENTAL_RATE ), MIN(FILM.RENTAL_RATE )  FROM FILM
GROUP BY FILM.RATING
ORDER BY 평균대여료 DESC;

-- 등급별 통계에서 영화가 200개 이상인 등급만 조회하세요:
-- - 등급, 영화 개수, 평균 대여료
SELECT FILM.RATING, COUNT(*), AVG(FILM.RENTAL_RATE ) FROM FILM
GROUP BY FILM.RATING
HAVING COUNT(*) > 200;

-- 대여료가 2.99 이상인 영화만 집계하여, 등급별 통계를 조회하세요.
-- 단, 해당 등급의 영화가 50개 이상인 경우만 표시:
-- - 등급, 영화 개수, 평균 대여료
SELECT FILM.RATING, COUNT(*), AVG(FILM.RENTAL_RATE ) FROM FILM
WHERE FILM.RENTAL_RATE >= 2.99
GROUP BY FILM.RATING
HAVING COUNT(*) >50;

-- 배우(actor) 테이블에서 성(last_name)별 배우 수를 조회하세요:
-- - 성, 배우 수, 배우가 2명 이상인 성만 표시
-- - 배우 수 내림차순 정렬
SELECT *  FROM actor

SELECT ACTOR.LAST_NAME , count(*) FROM ACTOR
GROUP BY LAST_NAME
HAVING Count(*) > 2
ORDER BY count(*) DESC;
