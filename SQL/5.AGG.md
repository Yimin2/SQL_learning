USE world;

SELECT * FROM COUNTRY;
SELECT count(*) AS '총 국가수' FROM COUNTRY;

SELECT COUNT(COUNTRY.LIFEEXPECTANCY) FROM COUNTRY;

SELECT COUNT(DISTINCT country.REGION) FROM country;

SELECT SUM(Population) FROM COUNTRY;
SELECT SUM(COUNTRY.POPULATION) FROM COUNTRY
WHERE COUNTRY.CONTINENT = 'asia';

SELECT SUM(COUNTRY.POPULATION) FROM COUNTRY
WHERE COUNTRY.POPULATION  >= 100000000;

SELECT ROUND(SUM(COUNTRY.SURFACEAREA) / 1000,1) FROM COUNTRY;

SELECT AVG(COUNTRY.POPULATION) FROM COUNTRY;

SELECT AVG(COUNTRY.POPULATION) FROM COUNTRY
WHERE COUNTRY.CONTINENT = 'asia';

SELECT MAX(COUNTRY.POPULATION) FROM COUNTRY;

SELECT * FROM COUNTRY
WHERE COUNTRY.POPULATION = (SELECT MAX(COUNTRY.POPULATION) FROM COUNTRY);

SELECT  
COUNT(*),
SUM(POPULATION),
AVG(POPULATION),
MAX(POPULATION),
MIN(POPULATION)
FROM COUNTRY ;

SELECT LifeExpectancy FROM COUNTRY;
SELECT AVG(COUNTRY.LIFEEXPECTANCY) FROM COUNTRY;
SELECT AVG(COALESCE(COUNTRY.LIFEEXPECTANCY, 50)) FROM COUNTRY

USE sakila;
-- 전체 영화 개수
SELECT COUNT(*) FROM film;
-- 등급(rating)이 'PG'인 영화 개수
SELECT COUNT(film.RATING ) FROM film
WHERE film.RATING ="PG";
-- 서로 다른 등급(rating)의 개수
SELECT COUNT(DISTINCT film.RATING ) FROM film;
-- 모든 영화의 대여료(rental_rate) 합계
SELECT SUM(rental_rate) FROM FILM ;
-- 모든 영화의 평균 대여료 (소수점 둘째 자리)
SELECT AVG(rental_rate) FROM film;
-- 등급이 'R'인 영화의 평균 대여료
SELECT AVG(rental_rate) FROM film
WHERE rating="R";
-- 가장 비싼 대여료와 해당 영화 제목

SELECT film.TITLE, film.RENTAL_RATE   FROM film
WHERE film.RENTAL_RATE = (SELECT MAX(rental_rate) FROM FILM);

-- 가장 긴 상영 시간(length)과 해당 영화 제목
SELECT LENGTH, title  FROM FILM
WHERE FILM.LENGTH = (SELECT MAX(LENGTH) FROM FILM);
-- 가장 짧은 상영 시간과 해당 영화 제목
SELECT LENGTH, title  FROM FILM
WHERE FILM.LENGTH = (SELECT MIN(LENGTH) FROM FILM);
-- film 테이블의 다음 통계를 한 번에 조회하세요
-- 		전체 영화 수, 총 대여료 합계, 평균 대여료, 최고 대여료, 최저 대여료, 평균 상영 시간
SELECT count(*), SUM(FILM.RENTAL_RATE), AVG(FILM.RENTAL_RATE), MAX(FILM.RENTAL_RATE ), MIN(FILM.RENTAL_RATE), AVG(length) FROM FILM 

